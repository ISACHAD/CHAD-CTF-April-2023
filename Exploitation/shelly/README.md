# shelly

Just get shell. That's it.

## Solution
Looks like our constraints prrevent us from making a syscall since it filters out any `0x05` byte. So we gotta get shell somehow (or read a file) without writing a syscall. That might be a bit hard to do. There's another way that we can go about doing this too.

Maybe we instead write some polymorphic shellcode! Go to [here](https://shell-storm.org/shellcode/index.html) and find your favorite linux x86_64 shellcode. Here I chose a [27 byte shellcode](https://shell-storm.org/shellcode/files/shellcode-806.html) and just changed the last byte to `0x04` instead. That should pass the filter, but unfortunately it doesn't get us a shell anymore.  

We can then add an instruction that will add 1 to the last byte, but this doesn't work since the opcode for `add byte ptr` contains the `0x05` byte. rip. Instead, we can XOR the last byte to change it since that opcode doesn't include the `0x05` byte.

After adding this little bit, here's the final shellcode:
`\x80\x35\x1a\x00\x00\x00\x01\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x04`

Send these bytes to the server and achieve shell. 

`CHAD{cr34tive_sh3llc0de_ftw!}`
